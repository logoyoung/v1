function Calendar(a,b,c,d,e,f){this.beginYear=a||2010,this.endYear=b||2030,this.language=c||0,this.patternDelimiter=d||"-",this.date2StringPattern=e||Calendar.language["date2StringPattern"][this.language].replace(/\-/g,this.patternDelimiter),this.string2DatePattern=f||Calendar.language["string2DatePattern"][this.language],this.dateControl=null,this.panel=this.getElementById("__calendarPanel"),this.iframe=window.frames["__calendarIframe"],this.form=null,this.date=new Date,this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.colors={bg_cur_day:"#00CC33",bg_over:"#EFEFEF",bg_out:"#FFCC00"}}var __ci,calendar;Calendar.language={year:["年","","","年"],months:[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]],weeks:[["日","一","二","三","四","五","六"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["日","一","二","三","四","五","六"]],clear:["清空","Clear","Clear","清空"],today:["今天","Today","Today","今天"],close:["关闭","Close","Close","關閉"],date2StringPattern:["yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd"],string2DatePattern:["ymd","ymd","ymd","ymd"]},Calendar.prototype.draw=function(){var a,b,c;for(calendar=this,a=[],a[a.length]='<form id="__calendarForm" name="__calendarForm" method="post">',a[a.length]='<table id="__calendarTable" width="100%" border="0" cellpadding="3" cellspacing="1" align="center">',a[a.length]=" <tr>",a[a.length]='  <th><input class="l" name="goPrevMonthButton" type="button" id="goPrevMonthButton" value="&lt;" /></th>',a[a.length]='  <th colspan="5"><select class="year" name="yearSelect" id="yearSelect"></select><select class="month" name="monthSelect" id="monthSelect"></select></th>',a[a.length]='  <th><input class="r" name="goNextMonthButton" type="button" id="goNextMonthButton" value="&gt;" /></th>',a[a.length]=" </tr>",a[a.length]=" <tr>",b=0;7>b;b++)a[a.length]='<th class="theader">',a[a.length]=Calendar.language["weeks"][this.language][b],a[a.length]="</th>";for(a[a.length]="</tr>",b=0;6>b;b++){for(a[a.length]='<tr align="center">',c=0;7>c;c++)switch(c){case 0:a[a.length]='<td class="sun">&nbsp;</td>';break;case 6:a[a.length]='<td class="sat">&nbsp;</td>';break;default:a[a.length]='<td class="normal">&nbsp;</td>'}a[a.length]="</tr>"}a[a.length]=" <tr>",a[a.length]='  <th colspan="2"><input type="button" class="b" name="clearButton" id="clearButton" /></th>',a[a.length]='  <th colspan="3"><input type="button" class="b" name="selectTodayButton" id="selectTodayButton" /></th>',a[a.length]='  <th colspan="2"><input type="button" class="b" name="closeButton" id="closeButton" /></th>',a[a.length]=" </tr>",a[a.length]="</table>",a[a.length]="</form>",this.iframe.document.body.innerHTML=a.join(""),this.form=this.iframe.document.forms["__calendarForm"],this.form.clearButton.value=Calendar.language["clear"][this.language],this.form.selectTodayButton.value=Calendar.language["today"][this.language],this.form.closeButton.value=Calendar.language["close"][this.language],this.form.goPrevMonthButton.onclick=function(){calendar.goPrevMonth(this)},this.form.goNextMonthButton.onclick=function(){calendar.goNextMonth(this)},this.form.yearSelect.onchange=function(){calendar.update(this)},this.form.monthSelect.onchange=function(){calendar.update(this)},this.form.clearButton.onclick=function(){calendar.dateControl.value="",calendar.hide()},this.form.closeButton.onclick=function(){calendar.hide()},this.form.selectTodayButton.onclick=function(){var a=new Date;calendar.date=a,calendar.year=a.getFullYear(),calendar.month=a.getMonth(),calendar.dateControl.value=a.format(calendar.date2StringPattern),calendar.hide()}},Calendar.prototype.bindYear=function(){var b,a=this.form.yearSelect;for(a.length=0,b=this.beginYear;b<=this.endYear;b++)a.options[a.length]=new Option(b+Calendar.language["year"][this.language],b)},Calendar.prototype.bindMonth=function(){var b,a=this.form.monthSelect;for(a.length=0,b=0;12>b;b++)a.options[a.length]=new Option(Calendar.language["months"][this.language][b],b)},Calendar.prototype.goPrevMonth=function(){(this.year!=this.beginYear||0!=this.month)&&(this.month--,-1==this.month&&(this.year--,this.month=11),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData())},Calendar.prototype.goNextMonth=function(){(this.year!=this.endYear||11!=this.month)&&(this.month++,12==this.month&&(this.year++,this.month=0),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData())},Calendar.prototype.changeSelect=function(){var c,a=this.form.yearSelect,b=this.form.monthSelect;for(c=0;c<a.length;c++)if(a.options[c].value==this.date.getFullYear()){a[c].selected=!0;break}for(c=0;c<b.length;c++)if(b.options[c].value==this.date.getMonth()){b[c].selected=!0;break}},Calendar.prototype.update=function(a){this.year=a.form.yearSelect.options[a.form.yearSelect.selectedIndex].value,this.month=a.form.monthSelect.options[a.form.monthSelect.selectedIndex].value,this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData()},Calendar.prototype.bindData=function(){var d,e,a=this,b=this.getMonthViewDateArray(this.date.getFullYear(),this.date.getMonth()),c=this.getElementsByTagName("td",this.getElementById("__calendarTable",this.iframe.document));for(d=0;d<c.length;d++)c[d].style.backgroundColor=a.colors["bg_over"],c[d].onclick=null,c[d].onmouseover=null,c[d].onmouseout=null,c[d].innerHTML=b[d]||"&nbsp;",d>b.length-1||b[d]&&(c[d].onclick=function(){a.dateControl&&(a.dateControl.value=new Date(a.date.getFullYear(),a.date.getMonth(),this.innerHTML).format(a.date2StringPattern)),a.hide()},c[d].onmouseover=function(){this.style.backgroundColor=a.colors["bg_out"]},c[d].onmouseout=function(){this.style.backgroundColor=a.colors["bg_over"]},e=new Date,e.getFullYear()==a.date.getFullYear()&&e.getMonth()==a.date.getMonth()&&e.getDate()==b[d]&&(c[d].style.backgroundColor=a.colors["bg_cur_day"],c[d].onmouseover=function(){this.style.backgroundColor=a.colors["bg_out"]},c[d].onmouseout=function(){this.style.backgroundColor=a.colors["bg_cur_day"]}))},Calendar.prototype.getMonthViewDateArray=function(a,b){var f,c=new Array(42),d=new Date(a,b,1).getDay(),e=new Date(a,b+1,0).getDate();for(f=0;e>f;f++)c[f+d]=f+1;return c},Calendar.prototype.show=function(a,b){if("visible"==this.panel.style.visibility&&(this.panel.style.visibility="hidden"),!a)throw new Error("arguments[0] is necessary!");this.dateControl=a,b=b||a,this.draw(),this.bindYear(),this.bindMonth(),a.value.length>0&&(this.date=new Date(a.value.toDate(this.patternDelimiter,this.string2DatePattern)),this.year=this.date.getFullYear(),this.month=this.date.getMonth()),this.changeSelect(),this.bindData();var c=this.getAbsPoint(b);this.panel.style.left=c.x+"px",this.panel.style.top=c.y+a.offsetHeight+"px",this.panel.style.visibility="visible"},Calendar.prototype.hide=function(){this.panel.style.visibility="hidden"},Calendar.prototype.getElementById=function(a,b){return b=b||document,document.getElementById?b.getElementById(a):document.all(a)},Calendar.prototype.getElementsByTagName=function(a,b){return b=b||document,document.getElementsByTagName?b.getElementsByTagName(a):document.all.tags(a)},Calendar.prototype.getAbsPoint=function(a){for(var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop;return{x:b,y:c}},Date.prototype.format=function(a){var c,b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"日一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a},String.prototype.toDate=function(a,b){var c,d,e,f;return a=a||"-",b=b||"ymd",c=this.split(a),d=parseInt(c[b.indexOf("y")],10),d.toString().length<=2&&(d+=2e3),isNaN(d)&&(d=(new Date).getFullYear()),e=parseInt(c[b.indexOf("m")],10)-1,f=parseInt(c[b.indexOf("d")],10),isNaN(f)&&(f=1),new Date(d,e,f)},document.writeln('<div id="__calendarPanel" style="position:absolute;visibility:hidden;z-index:9999;background-color:#FFFFFF;border:1px solid #666666;width:200px;height:216px;">'),document.writeln('<iframe name="__calendarIframe" id="__calendarIframe" width="100%" height="100%" scrolling="no" frameborder="0" style="margin:0px;"></iframe>'),__ci=window.frames["__calendarIframe"],__ci.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'),__ci.document.writeln('<html xmlns="http://www.w3.org/1999/xhtml">'),__ci.document.writeln("<head>"),__ci.document.writeln('<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />'),__ci.document.writeln("<title>Web Calendar(UTF-8) Written By KimSoft</title>"),__ci.document.writeln('<style type="text/css">'),__ci.document.writeln("<!--"),__ci.document.writeln("body {font-size:12px;margin:0px;text-align:center;}"),__ci.document.writeln("form {margin:0px;}"),__ci.document.writeln("select {font-size:12px;background-color:#EFEFEF;}"),__ci.document.writeln("table {border:0px solid #CCCCCC;background-color:#FFFFFF}"),__ci.document.writeln("th {font-size:12px;font-weight:normal;background-color:#FFFFFF;}"),__ci.document.writeln("th.theader {font-weight:normal;background-color:#666666;color:#FFFFFF;width:24px;}"),__ci.document.writeln("select.year {width:64px;}"),__ci.document.writeln("select.month {width:60px;}"),__ci.document.writeln("td {font-size:12px;text-align:center;}"),__ci.document.writeln("td.sat {color:#0000FF;background-color:#EFEFEF;}"),__ci.document.writeln("td.sun {color:#FF0000;background-color:#EFEFEF;}"),__ci.document.writeln("td.normal {background-color:#EFEFEF;}"),__ci.document.writeln("input.l {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:20px;height:20px;}"),__ci.document.writeln("input.r {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:20px;height:20px;}"),__ci.document.writeln("input.b {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:100%;height:20px;}"),__ci.document.writeln("-->"),__ci.document.writeln("</style>"),__ci.document.writeln("</head>"),__ci.document.writeln("<body>"),__ci.document.writeln("</body>"),__ci.document.writeln("</html>"),__ci.document.close(),document.writeln("</div>"),calendar=new Calendar;