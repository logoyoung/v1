{"version":3,"sources":["../../javascripts/liveroom.js"],"names":["$","END_FIXED","HEART_CONTENT","HEART_TIMER","LINK_TIMER","COMMAND_MAP","DEFAULT_MESS_MAP","SOCKET_CODE_MAP","ROOM_CODE_ERROR","webSocketUrl","giftList","ROOM","a","content","enc","command","data","recive_ms_decode","chat_ms_trans","base64","decode","d","toJSON","t","eval","uid","ROOMID","nn","console","log","tpl","welcomeDom","append","domScroll","msgDom","giftDom","silenceDom","followDom","liveEnding","anchorStart","setTimeout","location","href","e","mobileTips","setProperty","userLvIcon","userGroup","sayUser","sayMessage","sendUser","sendContent","sendTimes","followUser","silenceM","connect","webSocket","WebSocket","onopen","LOGIN_MESSAGE","UID","ENCPASS","send","onclose","onerror","onmessage","mes","QuerySocketStr","includes","openLock","heartBeat","chat_ms_check","HEART_MESSAGE","setInterval","on","loginEvent","messageContent","value","val","send_ms_encode","hide","removeClass","blur","gid","attr","num","send_gift_encode","giftLock","beanLock","geetestLock","beanTime","bean_level","LIVEID","$ROOM","config","getCookie","QueryLocation","luid","u","liveid","requestUrl","$conf","api","requestData","encpass","ajaxRequest","url","responseData","liveID","index","parseInt","Math","random","toFixed","web_socket","LiveRoom","init","desc","initInfo","html","title","document","isLiving","find","show","addClass","anchor","head","poster","orientation","level","nick","numberFormat","viewCount","gameName","followStatus","isFollow","initUserInfo","initStream","user","userInfo","hpbean","hpcoin","setUserCoin","setUserBean","status","stream","streamFix","streamList","waitStream","streamIndex","indexOf","oldUrl","substr","rep","RegExp","successUrl","replace","m3u8URL","video","enableInlineVideo","play","_initLogin","_initLayer","_initBindVideoEvent","_initVideoPlayAddress","_initChangeView","_initAnchorInfo","_initBindChatEvent","_initBeanTime","_initBindBeanEvent","_initBindGiftEvent","bindGesture","preventDefault","history","length","window","domain","go","swiper","Swiper","pagination","emojiIndex","textObj","get","all","createTextRange","caretPos","text","charAt","setSelectionRange","rangeStart","selectionStart","rangeEnd","selectionEnd","tempStr1","substring","tempStr2","focus","len","navigator","userAgent","match","webkitEnterFullScreen","tap","videoBar","videoPlayBtn","css","hasClass","pause","size","htmlArr","list","resList","i","push","CreateDom","item","userCount","luids","requsetData","event","lvl","time","timeSort","dom","minute","second","geetest","product","extend","vcode","type","recieve_bean","revCount","client","CreateLi","obj","id","giftname","cost","unit","giftEvent","lists","listOne","send_bean_encode","identity","str_encode","str","msg","toUnicode","mid","Date","getTime","way","compress","String_fixed","recive_str","zip_inflate","group","uGp","cunn","toEncode","replace_em","word","ounn","gname","giftIcon","timer","gnum","admin","adminNick","targetNick","fn","scrollTo","options","defaults","toT","scrollHeight","durTime","delay","callback","opts","_this","curTop","scrollTop","subTop","dur","round","smoothScroll","per","clearInterval","eq","remove","digitsFormat","coin","bean","b","interval"],"mappings":"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","file":"liveroom.js","sourcesContent":["/** Created by junxiao on 2017/7/28. */\n$(function () {\n    const END_FIXED = '\\r\\n';\n    const HEART_CONTENT = 'y8vPLwAA'; // 心跳码\n    const HEART_TIMER = 15 * 1000; //15s 正常16s 发送心跳、避免延迟 提高一秒\n    const LINK_TIMER = 5 * 1000; //5000ms 重连\n    const COMMAND_MAP = {\n        'result': 'sendCallback',\n        'receivemessage': 'receiveMessage',\n        'network.error': 'netError',\n        'SecurityError': 'securityError'\n    };\n    const DEFAULT_MESS_MAP = {\n        'login.success': '登陆成功',\n        'send.success': '发送成功'\n    };\n    const SOCKET_CODE_MAP = {\n        '501': 'welcome',\n        '502': 'msgShow',\n        '503': '',\n        '504': 'giftMsg',\n        '505': 'silenceMsg',\n        '506': 'userExit',\n        '507': 'follow', //关注\n        '508': 'share', //分享\n        '511': 'treasureopen',\n        '535': 'sendTheAir',\n        '540': 'liveNotice',\n        '541': 'liveStop',\n        '542': 'killUser',\n        '601': 'liveStart',\n        '602': 'liveEnd',\n        '701': 'rRankList',\n        '1100': 'sendCallBack',\n        '1102': 'sendBeanCallBack',\n        '1103': 'sendGiftCallBack',\n        '1104': 'succEnterCallBack'\n    };\n    const ROOM_CODE_ERROR = {\n        '-31'  :  \"用户欢朋币余额不足\",\n        '-32'  :  \"用户欢朋豆余额不足\",\n        '-33'  :  \"尚未认证手机\",\n        '-3001':  '聊天室初始化失败',\n        '-3002':  \"聊天室进入失败\",\n        '-3003':  \"聊天室退出失败\",\n        '-3004':  \"聊天室心跳失败\",\n        '-3005':  \"聊天室消息类型非法\",\n        '-3006':  \"聊天室消息发送失败\",\n        '-3007':  \"聊天室点赞失败\",\n        '-3008':  \"聊天室游客不能说话\",\n        '-3009':  \"用户被禁言，不能发言\",\n        '-3501':  \"消息表写入失败\",\n        '-3502':  \"用户发言失败\",\n        '-3503':  \"获取发言用户信息失败\",\n        '-3504':  \"获取直播信息失败\",\n        '-3505':  \"更新直播赞失败\",\n        '-3506':  \"点赞消息发送失败\",\n        '-3507':  \"获取主播信息失败\",\n        '-3508':  \"礼物全局通知信息发送失败\",\n        '-3509':  \"礼物房间信息发送失败\",\n        '-3510':  \"服务器繁忙\",\n        '-3511':  \"送礼请求参数错误\",\n        '-3512':  \"输入字符不能为空\",\n        '-3513':  \"输入字符不能超过20个字\",\n        '-3530':  \"输入字符含有敏感词汇\"\n    };\n    var webSocketUrl = '';\n    var giftList = {};\n    /**\n     * ROOM 工具类\n     */\n    class ROOM {\n        constructor() {}\n        static chat_ms_check(a) {\n            if (!DEFAULT_MESS_MAP[a.content]) {\n                if (a.enc == 'no' && COMMAND_MAP[a.command]) {\n                    return\n                }\n                // (解密 socket)\n                if (a.command == 'receivemessage' && a.content) {\n                    if (a.enc == 'yes') {\n                        let data = recive_ms_decode(a.content);\n                        //需 func 处理 JSON串\n                        this.chat_ms_trans(data)\n                    } else if (a.enc == 'no') {\n                        let data = base64.decode(a.content);\n                        this.chat_ms_trans(data)\n                    }\n                }\n            }\n        }\n        static chat_ms_trans(d) {\n            if (d) {\n                var data = toJSON(d);\n                if (SOCKET_CODE_MAP[data.t]) {\n                    eval('this.' + SOCKET_CODE_MAP[data.t] + '(' + d + ')')\n                } else {\n\n                }\n            }\n        }\n        static welcome(d) {\n            if(d.uid == ROOMID || d.nn == ''){\n                return;\n            }\n            console.log(d);\n            let tpl = ROOM.welcomeDom(d);\n            $('#chat-div').append(tpl);\n            domScroll();\n        }\n        static msgShow(d) {\n            /*if (!barragerLock) {\n             createBarrager(toEncode(d.msg));\n             }*/\n            console.log(d);\n            let tpl = ROOM.msgDom(d);\n            $('#chat-div').append(tpl);\n            domScroll();\n        }\n        static giftMsg(d) {\n            //手机 房管 Level 身份标识  msgid  wait\n            console.log(d);\n            let tpl = ROOM.giftDom(d);\n            $('#chat-div').append(tpl);\n            domScroll();\n        }\n        static silenceMsg(d) {\n            console.log(d);\n            let tpl = ROOM.silenceDom(d);\n            $('#chat-div').append(tpl);\n            domScroll();\n        }\n        static userExit(d) { /*console.log('one person exit');*/ }\n        static follow(d) {\n            console.log(d);\n            let tpl = ROOM.followDom(d);\n            $('#chat-div').append(tpl);\n            domScroll();\n        }\n        static share(d) {\n            console.log(d);\n        }\n        static treasureopen(d) {\n            // console.log(d);\n            //宝箱开启 暂无\n        }\n        static sendTheAir(d) {\n            //console.log(d);\n            //送飞船动画 暂无\n        }\n        static liveNotice(d) {\n            //console.log(d);\n            //H5直播提示 暂无\n        }\n        static liveStop(d) {\n            console.log(d);\n            ROOM.liveEnding();\n        }\n        static killUser(d) {\n            console.log(d);\n            ROOM.liveEnding();\n        }\n        static liveStart(d) {\n            console.log(d);\n            ROOM.anchorStart();\n        }\n        static liveEnd(d) {\n            console.log(d);\n            let tpl = ROOM.liveEnding();\n            $('#chat-div').append(tpl);\n            domScroll();\n            setTimeout(function () {\n                location.href = location.href;\n                //config();\n            }, 3000);\n        }\n        static rRankList(d) {\n            console.log(d);\n            //排行榜暂无\n        }\n        static sendCallBack(d) {\n            console.log(d)\n            if(ROOM_CODE_ERROR[d.e]){\n                mobileTips(ROOM_CODE_ERROR[d.e], 3);\n            }\n        }\n        static sendBeanCallBack(d) {\n            //giftLock = false;\n            console.log(d);\n            setProperty(d);\n            if(ROOM_CODE_ERROR[d.e]){\n                mobileTips(ROOM_CODE_ERROR[d.e], 3);\n            }\n        }\n        static sendGiftCallBack(d) {\n            //giftLock = false;\n            console.log(d);\n            setProperty(d);\n            if(ROOM_CODE_ERROR[d.e]){\n                mobileTips(ROOM_CODE_ERROR[d.e], 3);\n            }\n        }\n        static succEnterCallBack(d) {\n            console.log(d);\n        }\n        static welcomeDom(d){\n            return '<li class=\"chat-cell\"><img class=\"welcome\" src=\"images/emoji/welcome.png\"><span class=\"text\">&nbsp;欢迎&nbsp;</span>'+ userLvIcon(d) +'<span class=\"person-name normal\">'+d.nn+'</span><span class=\"text\">&nbsp;进入直播间</span></li>';\n        }\n        static msgDom(d){\n            return '<li class=\"chat-cell\">'+userGroup(d) + userLvIcon(d) + sayUser(d)  + sayMessage(d) +'</li>';\n        }\n        static giftDom(d){\n            return '<li class=\"chat-cell\">'+userGroup(d) + userLvIcon(d) + sendUser(d)  + sendContent(d) + sendTimes(d) + '</li>'\n        }\n        static followDom(d){\n            return '<li class=\"chat-cell\">'+ userGroup(d) + userLvIcon(d)+ followUser(d) + '</li>';\n        }\n        static silenceDom(d){\n            return '<li class=\"chat-cell\" style=\"color:#f44336;\">'+ silenceM(d) +'</li>';\n        }\n        static liveEnding(){\n            return '<li class=\"chat-cell\" style=\"color:#f44336;\"><span class=\"message\" style=\"color:#f44336;\">系统广播：直播结束</span></li>';\n        }\n        static anchorStart(){\n            location.href = location.href;\n            //config();\n        }\n    }\n\n    var connect = () => {\n        //websocket Events override\n        var webSocket = new WebSocket(webSocketUrl);\n        webSocket.onopen = (e => {\n            console.log('与服务器端建立连接');\n            let LOGIN_MESSAGE = 'command=login' + END_FIXED + 'uid=' + UID + END_FIXED + 'encpass=' + ENCPASS + END_FIXED + 'roomid=' + ROOMID + END_FIXED;\n            //尝试登陆\n            webSocket.send(LOGIN_MESSAGE);\n        });\n        webSocket.onclose = (e => {\n            setTimeout(function() {\n                connect();\n                console.log('正在重连...');\n            }, LINK_TIMER);\n            console.log('链接已断开');\n        });\n        webSocket.onerror = (e => {\n            connect();\n        });\n        webSocket.onmessage = (e => {\n            let mes = QuerySocketStr(e.data);\n            if (mes.content.includes('login.success')) {\n                openLock = true;\n                webSocket.heartBeat();\n            } else if (mes.content.includes('login.fail')) {\n                openLock = false;\n                webSocket.onclose();\n            }\n            ROOM.chat_ms_check(mes);\n        });\n        //heartbeat WebSocket心跳\n        webSocket.heartBeat = (e => {\n            let HEART_MESSAGE = 'command=sendmessage' + END_FIXED + 'content=' + HEART_CONTENT + END_FIXED;\n            setInterval(function() {\n                webSocket.send(HEART_MESSAGE);\n            }, HEART_TIMER);\n        });\n\n        // 发送消息\n        $('#sendMessage-btn').on('tap', function(){\n            if(!loginEvent()){\n                return;\n            }\n\n            var messageContent = $('#message-content');\n            var value = messageContent.val();\n            if(value != ''){\n                \n                /***/\n                webSocket.send(send_ms_encode(value));\n                $('.mask').hide() && $('.chat-box, .body').removeClass('int') && $('.chat-btn .input').blur() && $('#message-content').val('');\n            }else{\n                return;\n            }\n        });\n        //送礼\n        $('.lw_item').on('tap', function () {\n            if(!loginEvent()){\n                return;\n            }\n            var gid = $(this).attr('data-gid') ? $(this).attr('data-gid') : null;\n            var num = $(this).attr('data-num') ? $(this).attr('data-num') : 1;\n            if(gid && num){\n                webSocket.send(send_gift_encode(gid, num));\n                //giftLock = true;\n            }\n        })\n    };\n\n    /**\n     *@param: 礼物锁、socket锁\n     */\n    var giftLock = false,\n        openLock = false,\n        beanLock = false,\n        geetestLock = false,\n        beanTime = 0,\n        bean_level = 1,\n        UID = null,\n        ENCPASS = null,\n        ROOMID = null,\n        LIVEID = null,\n        $ROOM = null;\n    //配置UID ENC LUID等变量\n    var config  = () => {\n        UID     = getCookie('_uid')      || 3000000000;\n        ENCPASS = getCookie('_enc')      || 'gustuserenterencpass';\n        ROOMID  = QueryLocation().luid   || QueryLocation().u || ''; //luid = ROOMID\n        LIVEID  = QueryLocation().liveid   || '';\n        if(ROOMID == ''){\n            return;\n        }\n        var requestUrl  = $conf.api + 'room/getLiveRoomInfo.php';\n        var requestData = {\n                uid     : getCookie('_uid') || '',\n                encpass : getCookie('_enc') || '',\n                luid    : ROOMID\n        };\n        ajaxRequest({url:requestUrl, data:requestData}, function (responseData) {\n            console.log(responseData);\n            /*if(IsPC()){\n                location.href = $conf.domain + responseData.roomID;\n                return;\n            }*/\n            $ROOM = responseData;\n            ROOMID = $ROOM.luid;    //覆盖ROOMID\n            LIVEID = $ROOM.liveID; //覆盖LIVEID\n            var index = parseInt(Math.random().toFixed(0));\n            console.log('webSoket['+index+']');\n            if(!$ROOM.web_socket[index]){\n                webSocketUrl = 'ws://' + $ROOM.web_socket[0];\n            }else{\n                webSocketUrl = 'ws://' + $ROOM.web_socket[index];\n            }\n\n            LiveRoom.init();\n        }, function (responseData) {\n            mobileTips(responseData.desc, 3);\n        });\n    };\n    //初始化 房间信息\n    var initInfo = () => {\n\n        //初始化标题\n        $('header>span').html($ROOM.title);\n        document.title = $ROOM.title;\n        //初始化 直播状态及封面图\n        if($ROOM.isLiving == '0'){\n            $('.liveroom-content').find('.play-btn').hide();\n            $('.liveroom-content').find('.nolive').show();\n\n            $('.liveroom-content').find('.poster').show().addClass('filter').attr('src', $ROOM.anchor.head);\n        }else if($ROOM.isLiving == '1'){\n            $('.liveroom-content').find('.nolive').hide();\n            $('.liveroom-content').find('.play-btn').show();\n            $('.liveroom-content>.video').attr('poster', $ROOM.poster);\n            if($ROOM.orientation == '0' && $ROOM.poster != ''){\n                $('.liveroom-content').find('.poster').removeClass('filter').removeClass('landscape').addClass('portrait').attr('src', $ROOM.poster);\n            }else if($ROOM.orientation == '1'  && $ROOM.poster != ''){\n                $('.liveroom-content').find('.poster').removeClass('filter').removeClass('portrait').addClass('landscape').attr('src', $ROOM.poster);\n            }else{\n                $('.liveroom-content').find('.poster').hide();\n            }\n        }\n\n        //初始化 主播信息\n        //头像\n        $('.anchor-info').find('.room-head').attr('src', $ROOM.anchor.head);\n        //昵称\n        $('.anchor-info').find('.anchor-desc').html('<span class=\"ms-lv lv'+$ROOM.anchor.level+'\"></span><span class=\"room-title\">'+$ROOM.anchor.nick+'</span>');\n        //在线人数\n        $('.anchor-info').find('#viewCount').html(numberFormat($ROOM.viewCount));\n        //直播游戏名称\n        $('.anchor-info').find('.room-game').html($ROOM.gameName);\n        //初始化 关注状态\n        followStatus($ROOM.isFollow);\n        //初始化 个人信息\n        initUserInfo($ROOM);\n        //初始化 流地址\n        initStream(ROOMID);\n    };\n\n    //初始化 个人信息\n    var initUserInfo = function (a) {\n        if(!a || !a.user || !getCookie('_uid') || !getCookie('_enc')){\n            return;\n        }\n        var userInfo = a.user;\n        if(userInfo.hpbean && userInfo.hpcoin){\n            setUserCoin(userInfo.hpcoin);\n            setUserBean(userInfo.hpbean);\n            $('.gift-content').find('.userMoney').addClass('show');\n        }\n    };\n\n    //初始化 流地址\n    var initStream = function (ROOMID, status) {\n        var requestUrl = $conf.api+'live/getHlsStreamList.php';\n        var requestData = {\n            luid : ROOMID\n        };\n        ajaxRequest({url:requestUrl,data:requestData}, function (responseData) {\n            if(responseData.stream != ''){\n                //流地址前缀\n                var streamFix = responseData.streamList[0] + '/';\n                //待拼接流地址\n                var waitStream = responseData.stream;\n                //找到拼接位置\n                var streamIndex = responseData.stream.indexOf('?');\n                //待拼接内容\n                var oldUrl = responseData.stream.substr(0, streamIndex);\n                var rep = new RegExp(oldUrl);\n                //替换地址\n                var successUrl = waitStream.replace(rep, oldUrl + '/playlist.m3u8');\n                //拼接\n                var m3u8URL = 'http://'+streamFix + successUrl;\n\n                $('.video').attr('src', m3u8URL);\n\n                if(status == 1){\n                    var video = $('video')[0];\n                    enableInlineVideo(video);\n                    video.play();\n                    $('.video').addClass('play');\n                }else{\n                    return;\n                }\n            }else{\n                /* 下播状态 */\n\n            }\n        }, function (responseData) {\n            //error\n        });\n    };\n\n    // config => initGift =>webSocket => initInfo => initStream\n    //配置UID等 =>  socket服务登录 => 初始化房间信息 => 初始化 播放流地址\n    config();\n\n    var LiveRoom = {\n        init: function (){\n            this._initLogin();              //登录\n            this._initLayer();              //界面\n            this._initBindVideoEvent();     //直播视频相关事件\n            this._initVideoPlayAddress();   //直播地址相关事件\n            this._initChangeView();         //聊天 评论View切换\n            this._initAnchorInfo();         //主播信息及事件\n            this._initBindChatEvent();      //聊天相关事件\n            this._initBeanTime();\n            this._initBindBeanEvent();      //领豆相关事件\n            this._initBindGiftEvent();      //送礼相关事件\n        },\n        _initLogin: () => {\n\n        },\n        _initLayer: () => {\n            //返回上层页面\n            bindGesture($('#backToView'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                if( history.length == 1 || window.history.length == 1){\n                    location.href = $conf.domain + 'mobile/index.html';\n                }else{\n                    window.history.go(-1);\n                }\n\n            });\n            \n            //emoji\n            var swiper = new Swiper ('.swiper-container', {\n                pagination: '.swiper-pagination'\n            })\n            //emoji int\n            $('#emoji-content').find('.emoji').on('tap', function () {\n                var index = $(this).index() + 1;\n                var emojiIndex = '[em_'+index+']';\n\n                var textObj = $('#message-content').get(0);\n                if(document.all && textObj.createTextRange && textObj.caretPos){\n                    var caretPos=textObj.caretPos;\n                    caretPos.text = caretPos.text.charAt(caretPos.text.length-1) == '' ?\n                        emojiIndex+'' : emojiIndex;\n                } else if(textObj.setSelectionRange){\n                    var rangeStart=textObj.selectionStart;\n                    var rangeEnd=textObj.selectionEnd;\n                    var tempStr1=textObj.value.substring(0,rangeStart);\n                    var tempStr2=textObj.value.substring(rangeEnd);\n                    textObj.value=tempStr1+emojiIndex+tempStr2;\n                    textObj.focus();\n                    var len=emojiIndex.length;\n                    textObj.setSelectionRange(rangeStart+len,rangeStart+len);\n                    textObj.blur();\n                }else{\n                    textObj.value+=emojiIndex;\n                }\n\n            });\n        },\n        _initBindVideoEvent: () => {\n            //播放 按钮 事件\n            bindGesture($('.liveroom-content>.play-btn'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                //touchend\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                //tap\n                $('.liveroom-content>.video')[0].play();\n                $('.video').addClass('play');\n                if(window.navigator.userAgent.match(/OS [9]_\\d[_\\d]* like Mac OS X/i) || window.navigator.userAgent.match(/OS [8]_\\d[_\\d]* like Mac OS X/i)){\n                    $('.liveroom-content>.video')[0].play();\n                    $('.video').addClass('play');\n                    $('.liveroom-content>.video')[0].webkitEnterFullScreen();\n                }\n                setTimeout(function () {\n                    $('.liveroom-content>.play-btn').hide();\n                    $('.video-bar').addClass('show');\n                    setTimeout(function(){ $('.video-bar').removeClass('show')}, 5000);\n                    $('.liveroom-content>.poster').hide();\n                }, 1000);\n            });\n\n            //video-bar display\n            $('.liveroom-content>.video').tap(function () {\n                var videoBar = $('.video-bar');\n                var videoPlayBtn = $('.liveroom-content>.play-btn');\n                if(videoPlayBtn.css('display') == 'none'){\n                    videoBar.hasClass('show') ? videoBar.removeClass('show') : videoBar.addClass('show') && setTimeout(function(){ videoBar.removeClass('show')}, 5000)\n                }\n            });\n\n            //video pause\n            bindGesture($('.video-bar>.video-pause'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                //touchend\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                //tap\n                $('.liveroom-content>.video')[0].pause();\n                $('.video-bar').removeClass('show') && $('.play-btn').show();\n            });\n\n            $('.video-refresh').on('tap', function () {\n                initStream(ROOMID, 1);\n\n            });\n\n            //video webkit-fullscreen\n            bindGesture($('.video-bar>.video-full'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                //touchend\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                //tap\n                $('.liveroom-content>.video')[0].webkitEnterFullScreen();\n            });\n\n\n        },\n        _initVideoPlayAddress: () => {\n            var video = $('video').get(0);\n            enableInlineVideo(video);\n        },\n        _initChangeView: () => {\n            // 聊天 推荐 下划线 事件添加\n            $('#chatView-btn').on('tap', function () {\n                $('.sec-box li span').removeClass('sel');\n                $(this).addClass('sel');\n                $('.commend-selbox').hide() && $('.chat-selbox, .chat-box').show();\n            });\n            $('#commendView-btn').on('tap', function () {\n                $('.sec-box li span').removeClass('sel');\n                $(this).addClass('sel');\n                $('.chat-selbox, .chat-box').hide() && $('.commend-selbox').show();\n                if($('.commend-selbox .live-list').find('.live-one').length == 0){\n                    var requestUrl = $conf.api + 'other/guessYouLike.php';\n                    var requestData = {\n                        uid: getCookie('_uid') || '',\n                        encpass: getCookie('_enc') || '',\n                        size: 6\n                    };\n                    var htmlArr = [];\n                    ajaxRequest({url: requestUrl, data: requestData}, function (responseData) {\n                        if( responseData.list && responseData.list.length > 0 ){\n                            $('.commend-selbox .commend-title').show();\n                        }\n                        var resList = responseData.list;\n                        console.log(resList);\n                        for(var i = 0; i < resList.length; i++){\n                            htmlArr.push(CreateDom(resList[i]));\n                        }\n\n                        $('.commend-selbox').find('.live-list').html(htmlArr);\n                    }, function (responseData) {\n                        mobileTips(responseData.desc, 3);\n                    });\n                    $('.commend-selbox .live-list').html(htmlArr);\n                }\n            });\n\n            function CreateDom(item){\n                if(item.uid == ROOMID){\n                    return '';\n                }\n                if(item.orientation == 1){\n                    return '<li class=\"live-one\">\\\n                            <a href=\"'+$conf.domain+'mobile/room/room.html?luid='+item.uid+'\">\\\n                            <div class=\"poster\">\\\n                            <div class=\"snapshot\">\\\n                            <img class=\"horizontal\" src=\"'+item.poster+'\">\\\n                            <p class=\"game-title\">'+item.gameName+'</p>\\\n                        </div>\\\n                        <div class=\"profile-photo\">\\\n                            <img src=\"'+item.head+'\" alt=\"\">\\\n                            </div>\\\n                            <div class=\"poster-info\">\\\n                            <p class=\"poster-name\">'+item.title+'</p>\\\n                        <p class=\"audience\">'+numberFormat(item.userCount)+'人</p>\\\n                        </div>\\\n                        <section class=\"room-name\">'+item.nick+'</section>\\\n                        </div>\\\n                        </a>\\\n                        </li>';\n                }else{\n                    return '<li class=\"live-one\">\\\n                            <a href=\"'+$conf.domain+'mobile/room/room.html?luid='+item.uid+'\">\\\n                            <div class=\"poster\">\\\n                            <div class=\"snapshot\">\\\n                            <img class=\"vertical\" src=\"'+item.poster+'\">\\\n                            <p class=\"game-title\">'+item.gameName+'</p>\\\n                        </div>\\\n                        <div class=\"profile-photo\">\\\n                            <img src=\"'+item.head+'\" alt=\"\">\\\n                            </div>\\\n                            <div class=\"poster-info\">\\\n                            <p class=\"poster-name\">'+item.title+'</p>\\\n                        <p class=\"audience\">'+numberFormat(item.userCount)+'人</p>\\\n                        </div>\\\n                        <section class=\"room-name\">'+item.nick+'</section>\\\n                        </div>\\\n                        </a>\\\n                        </li>';\n                }\n            }\n        },\n        _initAnchorInfo: () => {\n            //主播信息 按钮 事件\n            bindGesture($('.anchor-display'), function(e){\n                //touchstart\n                e.preventDefault();\n                $('.anchor-info').hasClass('none') ?\n                    $(this).removeClass('hide').addClass('hide-high') :\n                    $(this).removeClass('show').addClass('show-high');\n            }, function () {\n                //touchend\n                $('.anchor-info').hasClass('none') ?\n                    $(this).removeClass('hide').addClass('hide-high') :\n                    $(this).removeClass('show-high').addClass('show');\n            }, function () {\n                //tap\n                $('.anchor-info').hasClass('none') ?\n                    $('.anchor-info, .chat-container').removeClass('none') &&\n                    $(this).removeClass('hide').removeClass('hide-high').addClass('show') :\n                    $('.anchor-info, .chat-container').addClass('none') &&\n                    $(this).removeClass('show').removeClass('show-high').addClass('hide');\n            });\n            //关注主播 按钮事件\n            $('.follow-btn').on('tap', function () {\n                if(!loginEvent()){\n                    return;\n                    //立即登录\n                }\n                if(UID && ENCPASS && ROOMID){\n                    var requestUrl = '';\n                    if(!$(this).hasClass('cancel')){\n                        requestUrl = $conf.api + 'room/followUser.php';\n                        var requestData = {\n                            uid: UID,\n                            encpass: ENCPASS,\n                            luid: ROOMID\n                        };\n                        ajaxRequest({url:requestUrl,data:requestData}, function (responseData) {\n                            followStatus(1);\n                        });\n                    }else{\n                        requestUrl = $conf.api + 'room/followUserCancel.php';\n                        var requestData = {\n                            uid: UID,\n                            encpass: ENCPASS,\n                            luids: ROOMID\n                        }\n                        ajaxRequest({url:requestUrl,data:requestData}, function (responseData) {\n                            followStatus(0);\n                        });\n                    }\n                }else{\n                    //else login\n                }\n            });\n        },\n        _initBindChatEvent: () => {\n            //聊天 按钮事件\n            bindGesture($('.chat-btn .input'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                //touchend\n                $(this).removeClass('high').addClass('normal');\n                $('.emoji-content').hasClass('show') ? $('.emoji-content').removeClass('show') : '';\n                $(this).focus() && $('.mask').show();\n            }, function () {\n                //tap\n                $(this).focus();\n            });\n\n            $('.chat-btn .input').focus(function () {\n                $('.chat-box ,.body').addClass('int');\n            }).blur(function () {\n                $('.body').removeClass('int');\n            });\n            //mask 取消input事件\n            $('.mask').on('tap', function () {\n                $(this).hide() && $('.chat-box, .body').removeClass('int') && $('.chat-btn .input').blur();\n            });\n\n            $('#emoji-content .delete-btn').on('tap', function () {\n                $('#message-content').val('');\n            });\n\n            //emoji 按钮事件\n            bindGesture($('.emoji-btn'), function (e) {\n                e.preventDefault();\n            }, function () {\n\n            }, function () {\n                if(!$('.emoji-content').hasClass('show')){\n                    $('.emoji-content').addClass('show') && $('.chat-btn .input').blur();\n                }else{\n                    $('.emoji-content').removeClass('show') && $('.chat-btn .input').focus();\n                }\n            });\n\n\n        },\n        _initBeanTime: () => {\n            if(!getCookie('_uid') || !getCookie('_enc')){\n                return;\n            }\n            var requestUrl = $conf.api + 'room/shamApi_gb_enter.php';\n            var requsetData = {\n                uid: getCookie('_uid'),\n                encpass: getCookie('_enc'),\n                luid: ROOMID,\n                event: 'enter'\n            };\n            ajaxRequest({url: requestUrl, data: requsetData}, function (responseData) {\n                console.log(responseData);\n                bean_level = responseData.lvl;\n                if(bean_level == 6){\n                    return;\n                }\n                if(responseData.time > 0){\n                    beanLock = false;\n                    beanTime = responseData.time;\n                    timeSort();\n                }else{\n                    beanLock = true;\n                }\n            }, function (responseData) {\n                mobileTips(responseData.desc, 3);\n            })\n        },\n        _initBindBeanEvent: () => {\n            //领豆 按钮事件\n            bindGesture($('.bean-btn'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                //touchend\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                console.log(beanLock);\n                if(!loginEvent()){\n                    return;\n                }\n                if(bean_level == 6){\n                    var dom = '已经领取6次咯~';\n                    mobileTips(dom ,3);\n                    return;\n                }\n                if(!beanLock && beanTime > 0){\n                    var minute = parseInt(beanTime / 60);\n                    var second = parseInt(beanTime % 60);\n                    \n                    if( minute > 0){\n                        var time = minute + ' 分钟后可领取';\n                        mobileTips(time, 1);\n                        return;\n                    }else{\n                        var time = second + ' 秒钟后可领取';\n                        mobileTips(time, 1);\n                        return;\n                    }\n                }else{\n                    if(!loginEvent()){\n                        return;\n                    }\n                    if(!geetestLock || $('.gt_holder').hasClass('gt_hide')){\n                        geetestLock = true;\n                        geetest({product: 'popup', append: '#geetest'}, function (data) {\n                            geetestLock = false;\n                            var requestData = $.extend({\n                                uid: getCookie('_uid'),\n                                encpass: getCookie('_enc'),\n                                luid: ROOMID,\n                                event: 'pick',\n                                lvl: bean_level,\n                                vcode: 0,\n                                type:'gt'\n                            }, data);\n\n                            var requestUrl = $conf.api + 'room/shamApi_gb_enter.php';\n                            ajaxRequest({url: requestUrl, data: requestData}, function (responseData) {\n                                console.log(responseData);\n                                var recieve_bean = '领取了 <span>' +responseData.revCount + '</span> 个欢朋豆';\n                                mobileTips(recieve_bean, 2);\n                                setProperty(responseData);\n                                bean_level = responseData.lvl;\n                                beanTime = responseData.time;\n                                timeSort();\n                                beanLock = false;\n                            }, function (responseData) {\n                                mobileTips(responseData.desc, 3);\n                            })\n                        })\n                    }else{\n                        return;\n                    }\n                }\n\n\n            });\n\n        },\n        _initBindGiftEvent: () => {\n            //initGift List\n            var requestUrl = $conf.api + 'gift/getGiftShowList.php';\n            var requestData = {\n                client : 1,\n                luid   : ROOMID\n            };\n            var CreateLi = function (obj) {\n              return '<li class=\"lw_item\" data-gid=\"'+obj.id+'\" data-num=\"'+obj.num+'\">\\\n                          <div class=\"img\">\\\n                            <img src=\"'+obj.poster+'\">\\\n                            </div>\\\n                            <p class=\"desc\">'+obj.giftname+'</p>\\\n                            <p class=\"price\">'+obj.cost+obj.unit+'</p>\\\n                        </li>';\n            };\n            var giftEvent = function (responseData) {\n                var htmlArr = [];\n                var lists = responseData.list;\n\n                for(var i = 0; i < lists.length; i++){\n                    var listOne = lists[i];\n                    giftList[listOne.id] = listOne.poster;\n                    htmlArr.push(CreateLi(listOne));\n                }\n                $('.gift-content').find('.gift-box').html(htmlArr);\n                connect();\n                initInfo();\n            };\n\n            ajaxRequest({url: requestUrl,data: requestData}, function (responseData) {\n                giftEvent(responseData);\n            }, function (responseData) {\n                mobileTips(responseData.desc, 3);\n            });\n            //gift modal\n            $('.modal').on('tap', function () {\n                $(this).hide();\n                $('.gift-content').removeClass('show');\n            });\n            //送礼 按钮事件\n            bindGesture($('.gift-btn'), function (e) {\n                //touchstart\n                e.preventDefault();\n                $(this).removeClass('normal').addClass('high');\n            }, function () {\n                $(this).removeClass('high').addClass('normal');\n            }, function () {\n                $('.gift-content').addClass('show') && $('.modal').show();\n            })\n        }\n    };\n\n\n    /**\n     * [送礼 加密]\n     * @param  {[string]} gid [需加密文字]\n     */\n    function send_gift_encode(gid, num) {\n        //gid   礼物 个数 (gid 暂定31-39)\n        if (!gid || gid < 30 || gid > 40) {\n            return\n        }\n        if(gid == '31' && num != ''){\n            return send_bean_encode(num)\n        }\n        if(!getCookie('_uid') || !getCookie('_enc')){\n            return false;\n            /**/\n        }\n        let content = {\n            t: 103,\n            enc: ENCPASS,\n            gid: gid,\n            liveid: LIVEID,\n            identity: '1'\n        };\n        return str_encode(content)\n    }\n    function send_bean_encode(num) {\n        if (!num || num < 1 || num > 10000) {\n            return\n        }\n        let content = {\n            t: 102,\n            enc: ENCPASS,\n            gid: '31', //欢朋豆 暂定 31\n            liveid: LIVEID,\n            num: num,\n            identity: '1'\n        };\n        return str_encode(content)\n    }\n    /**\n     * [发送消息 加密]\n     * @param  {[string]} str [需加密文字]\n     */\n    function send_ms_encode(str) {\n        if (!str) {\n            return;\n        }\n        if(!getCookie('_uid') || !getCookie('_enc')){\n            return false;\n            /**/\n        }\n        let content = {\n            t: 100,\n            uid: UID,\n            msg: toUnicode(str),\n            mid: new Date().getTime(),\n            way: 0\n        };\n        return str_encode(content);\n    }\n    /**\n     * [接收消息 解密]\n     * @param  {[string]} str [需解密文字]\n     */\n    function recive_ms_decode(str) {\n        //解密\n        let compress = String_fixed(str, 'decode');\n        let recive_str = zip_inflate(base64.decode(compress));\n        return recive_str\n    };\n    function userGroup(a){\n        if(!a || !a.group){ return; }\n        var uGp = parseInt(a.group);\n        if(uGp == 1){\n            return '';\n        }else if(uGp == 4){\n            return '<span class=\"mg\">房管</span>';\n        }else if(uGp == 5){\n            return '<span class=\"an\">主播</span>';\n        }\n    };\n    function userLvIcon(a) {\n        if(!a || !a.level){ return;}\n        return '<span class=\"us-lv lv'+ a.level +'\"></span>';\n    };\n    function sayUser(a) {\n        if(!a || !a.cunn){ return;}\n        return '<span class=\"person-name normal\">'+a.cunn+':</span>';\n    };\n    function sayMessage(a) {\n        if(!a || !a.msg){ return;}\n        return '<span class=\"message\">'+ toEncode(replace_em(a.msg)) +'</span>';\n    };\n    function replace_em(str){\n        str = str.replace(/\\</g,'&lt;');\n        str = str.replace(/\\>/g,'&gt;');\n        str = str.replace(/\\n/g,'<br/>');\n        str = str.replace(/\\[em_([0-9]*)\\]/g, function(word){\n\n            var num = word.match(/\\d{1,2}/g);\n            num = num[0] ? num[0] : '';\n            var str = word;\n            num && num < 23 && (str='<img class=\"emoji\" src=\"images/emoji/'+num+'.png\" >');\n            return str;\n        });\n        return str;\n    };\n    function sendUser(a) {\n        if(!a || !a.ounn){ return;}\n        return '<span class=\"person-name gift\">'+a.ounn+':</span>';\n    };\n    function sendContent(a) {\n        //礼物img\n        return '<span class=\"message\"> 赠送给主播</span><span class=\"person-name gift\">'+a.gname+'</span>'+ giftIcon(a) +'';\n    };\n    function giftIcon(a){\n        if(!a || !a.gid){ return;}\n        // a.gid\n        return '<img class=\"img\" src=\"'+ giftList[a.gid] +'\" >';\n    };\n    function sendTimes(a){\n        var time = a.timer ?\n            '<span class=\"message gift\">'+a.timer+'</span><span class=\"message fixed\">连击</span>' :\n            '<span class=\"message gift\">'+a.gnum+'</span><span class=\"message fixed\">粒</span>';\n        return time;\n    };\n    function followUser(d){\n        if(!d.nick || d.nick == ''){\n            return;\n        }\n        return '<span class=\"person-name normal\">'+d.nick+'</span><span class=\"message\">关注了主播</span>';\n    };\n    function followStatus(a) {\n        if(a == '1'){\n            $('.follow-btn').addClass('cancel').text('已关注');\n        }else{\n            $('.follow-btn').removeClass('cancel').text('关注');\n        }\n    };\n    function silenceM(a) {\n        if(!a || !a.admin || !a.adminNick){\n            return;\n        }\n        return '<span class=\"message\" style=\"color:#f44336;\">系统广播：用户</span><span class=\"message\" style=\"color:#f44336;\">'+a.targetNick+'</span><span class=\"message\" style=\"color:#f44336;\">被房管</span><span class=\"message\" style=\"color:#f44336;\">'+a.adminNick+'</span><span class=\"message\" style=\"color:#f44336;\">禁言一小时</span>';\n    };\n    $.fn.scrollTo =function(options){\n        var defaults = {\n            toT : $('.chat-container')[0].scrollHeight,    //滚动目标位置\n            durTime : 1000,  //过渡动画时间\n            delay : 10,     //定时器时间\n            callback:function () {\n                return;\n            }   //回调函数\n        };\n        var opts = $.extend(defaults,options),\n            timer = null,\n            _this = this,\n            curTop = _this.scrollTop(),//滚动条当前的位置\n            subTop = opts.toT - curTop,    //滚动条目标位置和当前位置的差值\n            index = 0,\n            dur = Math.round(opts.durTime / opts.delay),\n            smoothScroll = function(t){\n                index++;\n                var per = Math.round(subTop/dur);\n                if(index >= dur){\n                    _this.scrollTop(t);\n                    window.clearInterval(timer);\n                    if(opts.callback && typeof opts.callback == 'function'){\n                        opts.callback();\n                    }\n                    return;\n                }else{\n                    _this.scrollTop(curTop + index*per);\n                }\n            };\n        timer = window.setInterval(function(){\n            smoothScroll(opts.toT);\n        }, opts.delay);\n        return _this;\n    };\n    function domScroll(){\n        $('.chat-container').scrollTo();\n        if($('#chat-div').find('li').length > 88){\n            $('#chat-div').find('li').eq(0).remove();\n        }\n        // $('.chat-container').scrollTop($('.chat-container')[0].scrollHeight);\n    };\n    /* 设置 金豆金币余额 */\n    function setUserCoin(a){\n        $('.gift-content').find('.userMoney').find('.coinMoney').text(digitsFormat(a));\n    };\n    function setUserBean(a){\n        $('.gift-content').find('.userMoney').find('.beanMoney').text(digitsFormat(a));\n    };\n    function setProperty(a) {\n        if(!a || !a.coin || !a.bean){\n            return;\n        }\n        setUserCoin(a.coin);\n        setUserBean(a.bean);\n    };\n    /* mobileTips  1:loading 2:success 3:fail*/\n    function mobileTips(a, b){\n        if(b == 1){\n            $('.mobile-success, .mobile-fail').hide();\n            $('.mobile-loading .loading').html(a);\n            $('.mobile-tip, .mobile-loading').show();\n            setTimeout(function () {\n                $('.mobile-loading .loading').html('');\n                $('.mobile-tip, .mobile-loading').hide();\n            }, 1500)\n        }else if(b == 2){\n            $('.mobile-loading, .mobile-fail').hide();\n            $('.mobile-success .success').html(a);\n            $('.mobile-tip, .mobile-success').show();\n            setTimeout(function () {\n                $('.mobile-success .success').html('');\n                $('.mobile-tip, .mobile-success').hide();\n            }, 1500)\n        }else if(b == 3){\n            $('.mobile-success, .mobile-loading').hide();\n            $('.mobile-fail .fail').html(a);\n            $('.mobile-tip, .mobile-fail').show();\n            setTimeout(function () {\n                $('.mobile-fail .fail').html('');\n                $('.mobile-tip, .mobile-fail').hide();\n            }, 1500)\n        }\n    };\n    function timeSort() {\n        var interval = setInterval(function () {\n            if(beanTime <= 0){\n                beanLock = true;\n                clearInterval(interval);\n                return;\n            }\n            beanTime--;\n            console.log(beanTime);\n        }, 1000);\n    };\n\n    /* not Login */\n    function loginEvent() {\n        if(!getCookie('_uid') || !getCookie('_enc')){\n            mobileTips('您还没有登录哦~', 3);\n            setTimeout(function () {\n                location.href =  $conf.domain +'mobile/h5login/index.html?t='+ new Date().getTime();\n            },1200);\n            return false;\n        }else{\n            return true;\n        }\n    };\n});"]}